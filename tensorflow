{"name":"tensorflowPredict","version":"1.2.2","type":"sensor","script":"if (!waylayUtil.getProperty(options, 'modelName')) {\n    send(new Error('Missing property: modelName'), {observedState : \"Not predicted\"});\n}\nif (!waylayUtil.getProperty(options, 'instances')) {\n    send(new Error('Missing property: instances'), {observedState : \"Not predicted\"});\n}\nif (!waylayUtil.getProperty(options, 'method')) {\n    send(new Error('Missing property: method'), {observedState : \"Not predicted\"});\n}\n\nconst byomHostname = options.globalSettings.BYOM_HOST;\n\nconst modelName = waylayUtil.getProperty(options, 'modelName');\nconst instances = waylayUtil.getProperty(options, 'instances');\nconst method = waylayUtil.getProperty(options, 'method');\nconst signature = waylayUtil.getProperty(options, 'signatureName');\n\n// data for classify and regress\nvar data = {\"examples\": instances}\nif (method === 'predict'){\n    data = {\"instances\": instances}\n}   \n\nif (signature) {\n    data.signature_name = signature\n}\n\nvar requestOptions = {\n  url: `https://${byomHostname}/models/${modelName}/${method}`,\n  method: 'POST',\n  data: data\n};\n\nwaylay._request(requestOptions).then(body => {\n    send(null, {observedState: \"Predicted\", rawData: body});\n}).catch(err => {\n    console.log(err.response.data)\n    send(new Error(err), {observedState : \"Not predicted\"}); \n})\n","metadata":{"author":"Sam Persoon","category":"Tensorflow","description":"Tensorflow endpoint invoker.\n<br>\nUsed to invoke an upload Tensorflow model.\n<br><br>\n<b>States</b>\n<ul>\n    <li>\n        Not predicted: Indicates that something went wrong.\n    </li>\n    <li>\n        predicted: Indicates that the predictions are succesfully retrieved and the results are ready to use.\n    </li>\n</ul>\n<br>\n<b>Raw data</b>\n<ul>\n    <li>\n        prediction: This will contain the result returned by the specified model.\n    </li>\n</ul>\n<br>\n<b>Properties</b>\n<ul>\n    <li>\n        instances: The model inputs.\n    </li>\n    <li>\n        modelName: The model that should be used.\n    </li>\n    <li>\n        method: The method that should be used: regress/classify/predict.\n    </li>\n    <li>\n        signatureName: The optional signature to use instead of the default.\n    </li>\n</ul>\n<br>\n<b>Global settings</b>\n<br>\nThis sensor makes use of default value defined under the <code>BYOM_HOST</code> key within the Global Settings of your Waylay Console.\n","iconURL":"https://static.waylay.io/icons/tensor-logo.png","supportedStates":["Predicted","Not predicted"],"requiredProperties":["instances","modelName","method","signatureName"],"requiredRawData":[],"rawData":[{"parameter":"predictions","dataType":"object"}]}}