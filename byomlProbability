{"name":"byomlProbability","version":"1.0.0","type":"sensor","script":"if (!waylayUtil.getProperty(options, 'modelName')) {\n    send(new Error('Missing property: modelName'), {observedState : \"Not predicted\"});\n}\nif (!waylayUtil.getProperty(options, 'instances')) {\n    send(new Error('Missing property: instances'), {observedState : \"Not predicted\"});\n}\nconst byomHostname = options.globalSettings.waylay_byoml;\n\nconst modelName = waylayUtil.getProperty(options, 'modelName');\nconst instances = waylayUtil.getProperty(options, 'instances');\n\nvar requestOptions = {\n  url: `https://${byomHostname}/models/${modelName}/predict`,\n  method: 'POST',\n  data: {\"instances\": instances, \"probabilities\": true}\n};\n\nwaylay._request(requestOptions).then(body => {\n    send(null, {observedState: \"Predicted\", rawData: body});\n}).catch(err => {\n    console.error(err.response.data)\n    send(new Error(\"Failed to predict, check if model exists and if instances are in correct format.\"), {observedState : \"Not predicted\"}); \n})\n","metadata":{"author":"Sam Persoon","category":"BYOML","description":"BYOML endpoint invoker.\n<br>\nUsed to invoke an uploaded ML model, so it returns probabilities.\nThis sensor will only work for sklearn models.\n<br><br>\n<b>States</b>\n<ul>\n    <li>\n        Not predicted: Indicates that something went wrong.\n    </li>\n    <li>\n        predicted: Indicates that the predictions are succesfully retrieved and the results are ready to use.\n    </li>\n</ul>\n<br>\n<b>Raw data</b>\n<ul>\n    <li>\n        prediction: This will contain the result returned by the specified model.\n    </li>\n</ul>\n<br>\n<b>Properties</b>\n<ul>\n    <li>\n        instances: The model inputs.\n    </li>\n    <li>\n        modelName: The model that should be used.\n    </li>\n</ul>\n<br>\n<b>Global settings</b>\n<br>\nThis sensor makes use of default value defined under the <code>waylay_byoml</code> key within the Global Settings of your Waylay Console.\n","documentationURL":"https://docs.waylay.io/api/byoml/","iconURL":"https://static.waylay.io/icons/kubeflow.png","supportedStates":["Predicted","Not predicted"],"requiredProperties":["modelName","instances"],"requiredRawData":[],"rawData":[{"parameter":"predictions","dataType":"object"}]}}