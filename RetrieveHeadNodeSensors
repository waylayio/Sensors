{
    "name": "RetrieveHeadNodeSensors",
    "version": "0.2.1",
    "type": "sensor",
    "script": "/*var username;\nif (__.isEmpty(options.requiredProperties.username)) {\n    username = options.globalSettings.synfield_guest_username;\n} else {\n    username = waylayUtil.evaluateData(options, options.requiredProperties.username);\n}*/\n\nvar authorizationToken;\nvar headNode;\nif (__.isEmpty(options.requiredProperties.authorizationToken)) {\n    authorizationToken = options.globalSettings.synfield_guest_authorizationToken;\n} else {\n        try {\n        authorizationToken = waylayUtil.getRawData(options, options.requiredProperties.authorizationToken);\n    } catch (err) {\n        authorizationToken = options.requiredProperties.authorizationToken;\n    }\n}\n\nif (__.isEmpty(options.requiredProperties.headNode)) {\n    send(new Error('Please enter value for headNode.'))\n} else {\n        try {\n        headNode = waylayUtil.getRawData(options, options.requiredProperties.headNode);\n    } catch (err) {\n        headNode = options.requiredProperties.headNode;\n    }\n}\n\nvar url = ' http://api-synfield.synelixis.com/v1/gateway/' + headNode + '/sensors/';\n\ntry{\n    request({\n            'uri': url,\n            'headers' : {\n                'Authorization' : authorizationToken,\n                'Accept' : 'application/json'\n            }\n    }, function(err, response, body){\n        \n        if (!err && response.statusCode == 200) {\n                var data = JSON.parse(body);\n                \n                var value = {\n                    observedState : 'Found',\n                    rawData : {\n                        sensors : data.response.sensors\n                    }\n                };\n               send(null, value);\n            } else {\n                console.log(response);\n                send(new Error(\"Could not load the url\" + url + \" , got the error \" + err));\n            }\n    });    \n} catch(err){\n    send(new Error(err));\n}",
    "metadata": {
        "author": "Dan Dan",
        "category": "SynField",
        "description": "Retrieve a collection of installed sensors in the Head Node (gateway).<br>\nEndpoint: http://api-synfield.synelixis.com//v1/gateway/{gatewayID}/sensors/<br>\n\n<b>States</b>\n<ul>\n<li>Found: when an owner's sensors are found.</li>\n<li>Not Found</li>\n</ul><br>\n\n<b>Properties</b>\n<ul>\n<li>authorizationToken (e.g. Basic Z3Vlc3Q...) (if undefined, globalSettings)</li>\n<li>headNode (gateway) (e.g. 00:06:66...) (required)</li>\n</ul><br>\n\n<b>Raw Data</b>\n<ul>\n<li>sensors[]</li>\n</ul><br>",
        "documentationURL": "http://www.synelixis.com/synfield/",
        "iconURL": "http://www.micronzindia.com/mic_images/mic_icon_organic.png",
        "supportedStates": [
            "Found",
            "Not Found"
        ],
        "requiredProperties": [
            "authorizationToken",
            "headNode"
        ],
        "requiredRawData": [],
        "rawData": [
            {
                "parameter": "sensors",
                "dataType": "string[]"
            }
        ]
    }
}